# lru-cache-service
## Описание
**LRU Cache Service** — это сервис, реализующий кеш со стратегией **Least Recently Used (LRU)** и поддержкой **TTL** для каждого элемента. Сервис предоставляет RESTful API для добавления, получения и удаления данных из кеша.

## Возможности

- **Конфигурация через переменные окружения и флаги командной строки**.
- **Docker**: Упаковка сервиса в контейнер для удобного развертывания.
- **CI/CD**: Автоматическая сборка, тестирование и анализ кода при помощи GitHub Actions.
- **Логирование**: Гибкая настройка уровня логирования.

## Конфигурация

Сервис может быть настроен с помощью переменных окружения и флагов командной строки.

### Переменные окружения

- `SERVER_HOST_PORT` (по умолчанию `localhost:8080`): Адрес и порт сервера.
- `CACHE_SIZE` (по умолчанию `10`): Максимальное количество элементов в кеше.
- `DEFAULT_CACHE_TTL` (по умолчанию `60s`): Время жизни элементов кеша по умолчанию.
- `LOG_LEVEL` (по умолчанию `WARN`): Уровень логирования (`DEBUG`, `INFO`, `WARN`, `ERROR`).

### Флаги командной строки

- `-server-host-port`: Переопределяет `SERVER_HOST_PORT`.
- `-cache-size`: Переопределяет `CACHE_SIZE`.
- `-default-cache-ttl`: Переопределяет `DEFAULT_CACHE_TTL`.
- `-log-level`: Переопределяет `LOG_LEVEL`.

## Запуск

### Локальный запуск

Запустите сервис локально с помощью следующей команды:

```bash
go run ./cmd/app/main.go
```
### Запуск через Docker

**Сборка Docker-образа**

Соберите Docker-образ с помощью следующей команды:

```bash
docker build -t lru-cache-service
```

**Запуск контейнера**
```bash
docker run -d -p 8080:8080 --name lru-cache-service \
  -e SERVER_HOST_PORT=0.0.0.0:8080 \
  -e CACHE_SIZE=100 \
  -e DEFAULT_CACHE_TTL=120s \
  -e LOG_LEVEL=INFO \
  lru-cache-service
```
 **Пояснение параметров**

- `-d`: Запуск контейнера в фоновом режиме.
- `-p 8080:8080`: Проброс порта 8080 на хост-машину.
- `--name lru-cache-service`: Название контейнера.
- `-e SERVER_HOST_PORT=0.0.0.0:8080`: Установка переменной окружения для адреса и порта сервера.
- `-e CACHE_SIZE=100`: Установка размера кеша.
- `-e DEFAULT_CACHE_TTL=120s`: Установка времени жизни элементов кеша по умолчанию.
- `-e LOG_LEVEL=INFO`: Установка уровня логирования.
- `lru-cache-service`: Имя Docker-образа, который будет использоваться для создания контейнера.

## CI/CD

Проект использует **GitHub Actions** для автоматической сборки, тестирования и статического анализа кода при каждом пуше и pull-запросе в ветки `main` и `develop`.

### Конфигурация CI/CD

Файл конфигурации CI/CD находится по пути `.github/workflows/go.yaml` и включает следующие этапы:

1. **Сборка и тестирование**

2. **Статический анализ кода (SAST)**

# Логирование

Сервис использует пакет [`slog`](https://pkg.go.dev/log/slog) для логирования. Логирование позволяет отслеживать работу приложения, диагностировать проблемы и анализировать поведение кеша.

### Настройка уровня логирования

Уровень логирования можно настроить с помощью переменной окружения `LOG_LEVEL` или соответствующего флага командной строки `-log-level`. Поддерживаемые уровни логирования:

- `DEBUG`: Подробная информация для отладки.
- `INFO`: Общая информация о работе сервиса.
- `WARN`: Предупреждения о потенциальных проблемах.
- `ERROR`: Ошибки, требующие внимания.

**Пример использования переменной окружения:**
```bash
go run ./cmd/app/main.go -log-level=DEBUG
```
